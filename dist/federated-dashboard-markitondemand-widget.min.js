!function(a){"use strict";window.namespace=function(b,c){for(var d,e=window,f=b.split(".");d=f.shift();)e[d]=e[d]||{},e=e[d];a.extend(e,c)}}(window._),function(){namespace("Stock"),Stock.API=function(){function a(){}return a.loadChartData=function(a,b){var c;return c={parameters:JSON.stringify(this.prepareParams(a))},$.ajax({data:c,url:"http://dev.markitondemand.com/Api/v2/InteractiveChart/jsonp",dataType:"jsonp",context:this,success:b})},a.prepareParams=function(a){var b;return b=this.generateElements(a),{Normalized:!1,NumberOfDays:60,DataPeriod:"Day",Elements:b}},a.generateElements=function(a){var b,c,d,e;for(b=[],d=0,e=a.length;e>d;d++)c=a[d],b.push({Symbol:c,Type:"price",Params:["c"]});return b},a}()}.call(this),function(){namespace("Stock"),Stock.Controller=function(){function a(){}return a.bind=function(){return $("[data-id=stock-button]").click(function(a){return function(){return a.getStockData()}}(this))},a.getStockData=function(){var a;return a=this.processInput(),Stock.API.loadChartData(a,Stock.Display.showChart)},a.processInput=function(){var a;return a=Stock.Display.getInput(),a.split(/\s+/)},a.setupWidgetIn=function(a){return Stock.Display.showFormIn(a),this.bind()},a}()}.call(this),function(){namespace("Stock"),Stock.DataFormater=function(){function a(){}return a.formatData=function(a,b){return{rangeSelector:{selected:1,inputEnabled:$(b).width()>480},title:{text:"Stock Prices"},series:this.generateSeriesData(a)}},a.generateSeriesData=function(a){var b,c,d,e,f;for(c=[],f=a.Elements,d=0,e=f.length;e>d;d++)b=f[d],c.push(this.formatElementObj(b,a.Dates));return c},a.formatElementObj=function(a,b){return{name:a.Symbol,data:this.formatElementData(b,a.DataSeries.close.values),tooltip:{valueDecimals:2}}},a.formatElementData=function(a,b){var c,d,e,f;for(c=[],d=e=0,f=a.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c.push([new Date(a[d]).valueOf(),b[d]]);return c},a}()}.call(this),function(){namespace("Stock"),Stock.Display=function(){function a(){}return a.getInput=function(){return $("[name=stock-search]").val()},a.showFormIn=function(a){var b;return b=Stock.Templates.renderForm(),$(a).html(b)},a.logoSrc="https://raw.githubusercontent.com/bwvoss/federated-dashboard-markitondemand-widget/master/lib/icon_29406/stock_icon.png",a.generateLogo=function(a){var b;return b=this.logoSrc,_.extend(a,{imgSrc:b}),Stock.Templates.renderLogo(a)},a.showChart=function(a){var b;return b=Stock.DataFormater.formatData(a,"[data-id=stock-output]"),$("[data-id=stock-output]").highcharts("StockChart",b)},a}()}.call(this),function(){namespace("Stock"),Stock.Templates=function(){function a(){}return a.renderForm=function(){return _.template('<input name="stock-search" type="text"><br>\n<button id="stock" data-id="stock-button">Get Stock Data</button><br>\n<div data-id="stock-output"></div>')},a.renderEmptyTable=function(){return _.template('<table data-id="stock-display">\n  <thead>\n    <tr>\n      <th>Name</th>\n      <th>Change</th>\n      <th>Change Percent</th>\n      <th>Change Percent YTD</th>\n      <th>High</th>\n      <th>Low</th>\n      <th>Last Price</th>\n      <th>Market Cap</th>\n      <th>Open</th>\n      <th>Symbol</th>\n      <th>Volume</th>\n      <th>Time Stamp</th>\n    </tr>\n  </thead>\n  <tbody data-id="stock-body">\n  </tbody>\n</table>')},a.renderTableRow=function(a){return _.template("<tr>\n  <td><%= stockObj.name %></td>\n  <td><%= stockObj.change %></td>\n  <td><%= stockObj.changePercent %></td>\n  <td><%= stockObj.changePercentYTD %></td>\n  <td><%= stockObj.high %></td>\n  <td><%= stockObj.low %></td>\n  <td><%= stockObj.lastPrice %></td>\n  <td><%= stockObj.marketCap %></td>\n  <td><%= stockObj.open %></td>\n  <td><%= stockObj.symbol %></td>\n  <td><%= stockObj.volume %></td>\n  <td><%= stockObj.timestamp %></td>\n</tr>",{stockObj:a})},a.renderLogo=function(a){return _.template("<img src='<%= imgData['imgSrc'] %>' data-id='<%= imgData['dataId'] %>' style='width: <%= imgData['width'] %>px'/>",{imgData:a})},a}()}.call(this),function(){namespace("Stock"),Stock.View=function(){function a(){}return a.getInput=function(){return $("[name=stock-search]").val()},a.outputData=function(a){var b,c;return b=Stock.View.formatResponse(a),c=Stock.Templates.renderTableRow(b),$("[data-id=stock-body]").append(c)},a.resetTable=function(){var a;return a=Stock.Templates.renderEmptyTable(),$("[data-id=stock-output]").html(a)},a.displayFormIn=function(a){var b;return b=Stock.Templates.renderForm(),$(a).html(b)},a.formatResponse=function(a){return{name:a.Name,symbol:a.Symbol,change:a.Change.toFixed(2),changePercent:a.ChangePercent.toFixed(2),changePercentYTD:a.ChangePercentYTD.toFixed(2),open:a.Open.toFixed(2),changeYTD:a.ChangeYTD.toFixed(2),high:a.High,lastPrice:a.LastPrice,low:a.Low,msDate:a.MSDate.toFixed(2),marketCap:a.MarketCap,open:a.Open,timestamp:a.Timestamp.substr(0,18),volume:a.Volume}},a}()}.call(this);