!function(a){"use strict";window.namespace=function(b,c){for(var d,e=window,f=b.split(".");d=f.shift();)e[d]=e[d]||{},e=e[d];a.extend(e,c)}}(window._),function(){namespace("Stock"),Stock.API=function(){function a(){}return a.loadChartData=function(a,b){var c;return c={parameters:JSON.stringify(this.prepareParams(a))},$.ajax({data:c,url:"http://dev.markitondemand.com/Api/v2/InteractiveChart/jsonp",dataType:"jsonp",context:this,success:b})},a.prepareParams=function(a){var b;return b=this.generateElements(a),{Normalized:!1,NumberOfDays:60,DataPeriod:"Day",Elements:b}},a.generateElements=function(a){var b,c,d,e;for(b=[],d=0,e=a.length;e>d;d++)c=a[d],b.push({Symbol:c,Type:"price",Params:["c"]});return b},a}()}.call(this),function(){namespace("Stock"),Stock.Controller=function(){function a(){}return a.setupWidgetIn=function(a){return new Stock.Widgets.Controller(a).initialize()},a}()}.call(this),function(){namespace("Stock"),Stock.Display=function(){function a(){}return a.generateLogo=function(a){return'<i class="fa fa-bar-chart-o '+a["class"]+'" data-id="'+a.dataId+'"></i>'},a}()}.call(this),function(){namespace("Stock"),Stock.Templates=function(){function a(){}return a.renderLogo=function(a){return _.template("<img src='<%= imgData['imgSrc'] %>' data-id='<%= imgData['dataId'] %>' style='width: <%= imgData['width'] %>px'/>",{imgData:a})},a}()}.call(this),function(){namespace("Stock.Widgets"),Stock.Widgets.API=function(){function a(){}return a.loadChartData=function(a,b){var c;return c={parameters:JSON.stringify(this.prepareParams(a))},$.ajax({data:c,url:"http://dev.markitondemand.com/Api/v2/InteractiveChart/jsonp",dataType:"jsonp",context:this,success:function(a){return b.showChart(a)}})},a.prepareParams=function(a){var b;return b=this.generateElements(a),{Normalized:!1,NumberOfDays:60,DataPeriod:"Day",Elements:b}},a.generateElements=function(a){var b,c,d,e;for(b=[],d=0,e=a.length;e>d;d++)c=a[d],b.push({Symbol:c,Type:"price",Params:["c"]});return b},a}()}.call(this),function(){namespace("Stock.Widgets"),Stock.Widgets.Controller=function(){function a(a){b=a.key,this.container=a.container,this.display=new Stock.Widgets.Display(this.container,a.animationSpeed),this.defaultValue=a.defaultValue,this.activeStatus=!1}var b;return b=void 0,a.prototype.initialize=function(){return this.display.setupWidget(),this.bind(),this.displayDefault(),this.setAsActive()},a.prototype.displayDefault=function(){return this.defaultValue?this.loadStockData(this.defaultValue):void 0},a.prototype.setAsActive=function(){return this.activeStatus=!0},a.prototype.setAsInactive=function(){return this.activeStatus=!1},a.prototype.isActive=function(){return this.activeStatus},a.prototype.bind=function(){return $(""+this.container+" [data-name=widget-form]").on("submit",function(a){return function(b){return b.preventDefault(),a.getStockData()}}(this)),$(""+this.container+" [data-name=widget-close]").on("click",function(a){return function(){return a.closeWidget()}}(this))},a.prototype.getStockData=function(){var a;return a=this.display.getInput(),this.loadStockData(a)},a.prototype.loadStockData=function(a){var b;return b=this.processInput(a),Stock.Widgets.API.loadChartData(b,this.display)},a.prototype.processInput=function(a){return a.split(/\s+/)},a.prototype.closeWidget=function(){return this.unbind(),this.removeContent(),this.setAsInactive()},a.prototype.removeContent=function(){return this.display.removeWidget()},a.prototype.unbind=function(){return $(""+this.container+" [data-name=widget-form]").unbind("submit"),$(""+this.container+" [data-name=widget-close]").unbind("click")},a}()}.call(this),function(){namespace("Stock.Widgets"),Stock.Widgets.DataFormater=function(){function a(){}return a.formatData=function(a,b){return{rangeSelector:{selected:1,inputEnabled:$(b).width()>480},title:{text:"Stock Prices"},series:this.generateSeriesData(a)}},a.generateSeriesData=function(a){var b,c,d,e,f;for(c=[],f=a.Elements,d=0,e=f.length;e>d;d++)b=f[d],c.push(this.formatElementObj(b,a.Dates));return c},a.formatElementObj=function(a,b){return{name:a.Symbol,data:this.formatElementData(b,a.DataSeries.close.values),tooltip:{valueDecimals:2}}},a.formatElementData=function(a,b){var c,d,e,f;for(c=[],d=e=0,f=a.length;f>=0?f>e:e>f;d=f>=0?++e:--e)c.push([new Date(a[d]).valueOf(),b[d]]);return c},a}()}.call(this),function(){namespace("Stock.Widget"),Stock.Widgets.Display=function(){function a(a,b){this.container=a,this.animationSpeed=b}return a.prototype.setupWidget=function(){var a;return a=Stock.Widgets.Templates.renderForm(),$(this.container).append(a)},a.prototype.getInput=function(){return $(""+this.container+" [name=widget-input]").val()},a.prototype.showChart=function(a){var b;return b=Stock.Widgets.DataFormater.formatData(a,"[data-name=widget-output]"),$(""+this.container+" [data-name=widget-output]").highcharts("StockChart",b)},a.prototype.removeWidget=function(){return $(this.container).remove()},a}()}.call(this),function(){namespace("Stock.Widgets"),Stock.Widgets.Templates=function(){function a(){}return a.renderForm=function(){return _.template("<div class='widget' data-name='widget-wrapper'>\n  <div class='widget-header' data-name='sortable-handle'>\n    <h2 class=\"widget-title\">Stock</h2>\n    <span class='widget-close' data-name='widget-close'>Ã—</span>\n    <form class='widget-form' data-name='widget-form'>\n      <input name='widget-input' type='text' autofocus='true'>\n      <button data-name=\"form-button\">Get Stock Data</button><br>\n    </form>\n  </div>\n  <div class=\"widget-body\" data-name=\"widget-output\"></div>\n</div>",{})},a}()}.call(this);